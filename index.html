<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stella Xulin — Portfolio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
  <script type="module">
    import { animate, svg, stagger } from 'https://cdn.jsdelivr.net/npm/animejs@4.0.0/+esm';
    window.animejs = { animate, svg, stagger };
  </script>
  <script nomodule src="https://cdn.jsdelivr.net/npm/animejs@4.0.0/lib/anime.min.js"></script>
  <style>
    :root {
      --bg: #f8f6e8; /* light cream */
      --fg: #85ac7e; /* dark green */
      --nav-bg: #eddcd5; /* light pink/beige */
      --content-bg: #f8f6e8; /* light cream */
      --content-fg: #85ac7e; /* dark green */
      --muted: rgba(133, 172, 126, 0.6);
      --flash: rgba(133, 172, 126, 0.95);
      --rail-height: 672px; /* 8x previous 84px */
      --word-gap: 56px;
      --word-size: 72px; /* bigger words for tall slot */
      --speed: 190; /* px/sec base speed */
      --navbar-height: 70px; /* navbar height for positioning content */
    }

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
      box-sizing: border-box;
    }
    *, *::before, *::after {
      box-sizing: inherit;
    }
    html, body {
      height: 100%;
      overflow-x: hidden;
      width: 100%;
      margin: 0;
      padding: 0;
    }

    /* Prevent scrolling during animation */
    html.animating {
      overflow: hidden;
      overflow-y: hidden;
      position: fixed;
      width: 100%;
      height: 100%;
    }
    html.animating body {
      overflow: hidden;
      overflow-y: hidden;
      position: fixed;
      width: 100%;
      height: 100%;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: 'Merriweather', serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.6;
    }

    /* Stage */
    .stage {
      display: grid;
      place-items: center;
      min-height: 100dvh;
      padding: 24px;
    }

    /* When site content is shown, align to top */
    .stage.site-mode {
      place-items: start center;
      min-height: auto;
      padding: 0;
    }

    /* When showing site content, return it to normal flow */
    .stage.site-mode .site {
      position: static;
      margin-top: 0;
      padding-top: 0;
    }

    /* Rail wrapper with arrow indicator */
    .rail-wrap {
      position: relative;
      width: min(100%, 1400px);
      height: var(--rail-height);
      margin-inline: auto;
      transition: opacity 420ms ease, transform 420ms ease;
      transform-origin: center;
    }

    .rail-wrap.fade-out {
      opacity: 0;
      transform: scale(0.98);
      pointer-events: none;
    }

    /* Shrink vertically (close in on itself) from both ends toward center */
    .rail.shrink-out {
      clip-path: inset(50% 0 50% 0);
    }

    /* Arrow indicator (downward triangle) */
    .indicator {
      position: absolute;
      top: 50%;
      left: -18px;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-top: 9px solid transparent;
      border-bottom: 9px solid transparent;
      border-left: 14px solid var(--fg); /* right-pointing triangle */
      filter: drop-shadow(0 1px 0 rgba(0,0,0,.2));
      z-index: 2;
    }

    /* Rail */
    .rail {
      position: absolute;
      inset: 0;
      overflow: hidden;
      border-radius: 14px;
      border: 1px solid var(--nav-bg); /* lighter black outline */
      background: var(--nav-bg); /* lighter black backdrop */
      box-shadow: inset 0 1px 0 rgba(133, 172, 126, 0.2), 0 1px 2px rgba(0,0,0,.2);
      height: 100%;
      clip-path: inset(0 0 0 0);
      transition: clip-path 420ms ease;
      will-change: clip-path;
    }

    .track {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--word-gap);
      will-change: transform;
      padding-block: calc(50% - 24px);
      /* big padding to ensure words can pass the center */
    }

    .word {
      font-size: var(--word-size);
      line-height: 1;
      letter-spacing: 0.5px;
      color: var(--fg);
      transition: opacity 140ms ease;
      opacity: 0.28;
      white-space: nowrap;
      user-select: none;
    }

    .word.flash {
      opacity: 1;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Main site content (hidden until Welcome! lands) */
    .site {
      position: absolute; /* don't affect intro layout */
      top: 0; left: 0; right: 0;
      opacity: 0;
      transform: translateY(12px);
      filter: blur(2px);
      transition: opacity 600ms ease, transform 600ms ease, filter 600ms ease;
      max-width: none; /* full width */
      width: 100%;
      margin: 0;
      padding: 0;
      pointer-events: none;
    }

    .site.show {
      opacity: 1;
      transform: translateY(0);
      filter: blur(0);
      pointer-events: auto;
      margin-top: 0;
      top: 0;
    }

    .site h1 {
      font-size: clamp(42px, 7vw, 96px);
      line-height: 1.1;
      margin: 0 0 12px;
      font-weight: 700;
      letter-spacing: -0.02em;
    }
    /* Social strip under heading (optional) */
    .social {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 16px;
      margin: 8px 0 10px;
      font-size: 16px;
    }
    .social a { color: inherit; text-decoration: none; border-bottom: 1px dotted rgba(255,255,255,.5); }
    .social a:hover { border-bottom-style: solid; }
    .entry { 
      margin-bottom: 32px; 
      padding: 20px;
      background: rgba(237, 220, 213, 0.6);
      border-radius: 12px;
      border: 1px solid rgba(133, 172, 126, 0.2);
      transition: transform 200ms ease, box-shadow 200ms ease;
    }
    .entry:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
    }
    .entry h3 { 
      margin: 0 0 8px; 
      font-size: 20px; 
      font-weight: 600;
      color: rgba(133, 172, 126, 0.95);
      line-height: 1.3;
    }
    .entry h4 {
      margin: 16px 0 8px;
      font-size: 18px;
      font-weight: 600;
      color: rgba(133, 172, 126, 0.9);
      line-height: 1.3;
    }
    .meta { 
      font-size: 15px; 
      color: rgba(133, 172, 126, 0.7); 
      margin: 0 0 12px; 
      font-weight: 500;
    }
    ul.bullets { 
      margin: 0; 
      padding-left: 22px; 
      color: rgba(133, 172, 126, 0.85);
    }
    ul.bullets li { 
      margin: 8px 0; 
      line-height: 1.6;
    }
    .entry p {
      margin: 12px 0 0;
      color: rgba(133, 172, 126, 0.85);
      line-height: 1.7;
    }

    /* Media grid for images */
    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .media-grid img {
      width: 100%;
      height: 280px;
      object-fit: cover;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.1);
      transition: transform 300ms ease, box-shadow 300ms ease;
      cursor: pointer;
      display: block;
    }
    .content-section .media-grid img {
      border: 1px solid rgba(0,0,0,.1);
    }
    .media-grid img:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 8px 20px rgba(0,0,0,.4);
    }
    .media-grid .ph {
      aspect-ratio: 4 / 3;
      background: rgba(237, 220, 213, 0.3);
      border: 1px solid rgba(133, 172, 126, 0.3);
      border-radius: 12px;
      display: grid;
      place-items: center;
      color: rgba(133, 172, 126, 0.5);
      font-size: 14px;
    }

    /* Allow paragraph and grid/card content to render within the site */
    .site p { display: block; }

    .grid, .card { display: initial; }

    @media (prefers-reduced-motion: reduce) {
      .track { transition: none; }
      .word { transition: none; }
      .site { transition: none; }
    }

    /* Hero section layout */
    .hero-section {
      position: relative;
      min-height: 88vh; /* 1.1x of 80vh */
      display: grid;
      place-items: center;
      overflow: visible; /* allow overlap with semicircle */
      border-radius: 0;
      border: none;
      border-bottom: 1px solid rgba(133, 172, 126, 0.2);
      background: var(--bg);
      box-shadow: 0 4px 20px rgba(0,0,0,.2), inset 0 1px 0 rgba(133, 172, 126, 0.2);
      margin: 0;
      margin-top: 0;
      margin-bottom: -100px; /* overlap more with semicircle */
      width: 100vw;
      margin-left: calc(-50vw + 50%);
    }
    /* Ensure hero section starts right below fixed navbar with no gap */
    .site.show .hero-section {
      margin-top: 0;
    }
    /* For section pages, ensure content starts right below navbar with no gap */
    .site.show > .content:first-child {
      margin-top: 0;
      padding-top: 0;
    }
    .hero-slideshow { position:absolute; inset:0; }
    .hero-slide {
      position:absolute; inset:0;
      background: radial-gradient(ellipse at center, rgba(0,0,0,.06), rgba(0,0,0,.02));
      background-size: cover; background-position: center; background-repeat:no-repeat;
      opacity: 0; transition: opacity 1200ms ease-in-out;
      filter: contrast(0.9) brightness(0.98);
    }
    .hero-slide.active { opacity: 1; }
    .hero-section::before {
      content: ""; position:absolute; inset:0;
      background: linear-gradient(to bottom, rgba(248, 246, 232, 0.40), rgba(248, 246, 232, 0.78));
    }
    .hero-content { 
      position: absolute; 
      top: 35%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1; 
      text-align: center; 
      padding: 0 24px; 
      max-width: 800px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 80px; /* 2x margin with SVG */
    }
    .hero-section h1 {
      margin: 0 0 16px; 
      font-size: clamp(36px, 6vw, 64px);
      color: var(--fg);
      text-shadow: 0 2px 8px rgba(0,0,0,.5);
      font-weight: 700;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }
    /* Calligraphy SVG container */
    .calligraphy-container {
      margin: 0; /* spacing handled by parent flexbox gap */
      display: inline-block;
      width: 100%;
      max-width: 4800px; /* bigger bounds to prevent cutoff with scale(4) */
      height: auto;
      transform: scale(4); /* 2x the previous scale(2) */
      transform-origin: center top;
      overflow: visible; /* allow overflow to prevent cutoff */
      padding: 20px; /* extra padding to prevent edge cutoff */
      position: relative;
    }
    @media (max-width: 768px) {
      .calligraphy-container {
        transform: scale(1.5);
        max-width: 1800px;
        padding: 10px;
      }
    }
    @media (max-width: 480px) {
      .calligraphy-container {
        transform: scale(1);
        max-width: 1200px;
        padding: 8px;
      }
    }
    .calligraphy-container svg {
      width: 100%;
      height: auto;
      display: block;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,.8)) drop-shadow(0 2px 6px rgba(0,0,0,.6));
      overflow: visible;
    }
    .calligraphy-container svg path,
    .calligraphy-container svg polyline,
    .calligraphy-container svg line,
    .calligraphy-container svg circle,
    .calligraphy-container svg rect,
    .calligraphy-container svg ellipse,
    .calligraphy-container svg polygon {
      stroke: #85ac7e; /* dark green */
      fill: none; /* no fill, outline only */
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .hero-content p {
      font-size: clamp(16px, 2vw, 20px);
      line-height: 1.6;
      margin: 0;
    }
    .social-links { 
      display:flex; 
      gap:20px; 
      justify-content:center; 
      margin-top: 24px; 
      flex-wrap: wrap;
    }
    .social-link {
      padding: 10px 20px;
      background: rgba(237, 220, 213, 0.85);
      border: 1px solid rgba(133, 172, 126, 0.3);
      border-radius: 8px;
      text-decoration: none;
      color: inherit;
      font-size: 15px;
      transition: all 200ms ease;
      font-weight: 500;
    }
    .social-link:hover {
      background: rgba(218, 194, 198, 0.95);
      border-color: rgba(133, 172, 126, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,.1);
    }
    .social-icon { width: 32px; height:32px; }

    /* Semicircle separator between hero and content */
    .semicircle-separator {
      position: relative;
      width: 100%;
      height: 120px;
      background: var(--bg);
      overflow: visible;
      margin-top: 160px; /* offset */
      z-index: 1; /* below About section */
    }
    .semicircle-separator::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 150%; /* bigger radius */
      height: 300px; /* bigger radius */
      background: var(--content-bg);
      border-radius: 50% 50% 0 0 / 100% 100% 0 0;
    }

    .content-section {
      margin-top: 56px; 
      padding: 0; 
      max-width: none;
      margin-left: 0;
      margin-right: 0;
      width: 100%;
      position: relative;
      z-index: 1;
    }
    .content-section:first-of-type {
      margin-top: -120px; /* moved up more to be closer to semicircle */
      z-index: 3; /* above semicircle */
    }
    .content-section h2 {
      font-size: clamp(26px, 4vw, 42px);
      margin: 0 0 24px; 
      letter-spacing: -0.01em;
      font-weight: 700;
      color: rgba(133, 172, 126, 0.95);
      padding-bottom: 12px;
      border-bottom: 2px solid rgba(133, 172, 126, 0.2);
    }
    /* Remove border for alternating sections */
    .alternating-section + .content-section h2,
    .content-section .alternating-section ~ h2 {
      border: none;
      padding: 0;
    }

    .about-content { 
      display:flex; 
      gap: 32px; 
      align-items: center; 
      flex-wrap: wrap; 
      margin-top: 20px;
    }
    .about-image { 
      flex: 1 1 128px; /* smaller size */
      min-width: 104px; /* smaller min-width */
    }
    .about-image img { 
      width: 100%; 
      border-radius: 14px; 
      border:1px solid rgba(0,0,0,.1); 
      box-shadow: 0 4px 16px rgba(0,0,0,.1); 
      transition: transform 300ms ease;
    }
    .content-section .about-image img {
      border:1px solid rgba(0,0,0,.1);
      box-shadow: 0 4px 16px rgba(0,0,0,.1);
    }
    .about-image img:hover {
      transform: scale(1.02);
    }
    .about-text { 
      flex: 2 1 500px; 
    }
    .about-text p { 
      color: rgba(133, 172, 126, 0.85); 
      font-size: 17px; 
      line-height: 1.7; 
      margin: 0 0 16px;
    }

    /* Podcast content layout */
    .podcast-content {
      display: flex;
      gap: 32px;
      align-items: flex-start;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .podcast-image {
      flex: 1 1 300px;
      min-width: 250px;
    }
    .podcast-image img {
      width: 100%;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.1);
      box-shadow: 0 4px 16px rgba(0,0,0,.1);
      transition: transform 300ms ease;
    }
    .content-section .podcast-image img {
      border: 1px solid rgba(0,0,0,.1);
      box-shadow: 0 4px 16px rgba(0,0,0,.1);
    }
    .podcast-image img:hover {
      transform: scale(1.02);
    }
    .podcast-text {
      flex: 2 1 400px;
    }
    .podcast-text h3 {
      margin: 0 0 12px;
      font-size: 20px;
      font-weight: 600;
      color: rgba(133, 172, 126, 0.95);
      line-height: 1.3;
    }
    .podcast-text p {
      color: rgba(133, 172, 126, 0.85);
      font-size: 17px;
      line-height: 1.7;
      margin: 0 0 16px;
    }
    @media (max-width: 768px) {
      .podcast-content {
        flex-direction: column;
      }
      .podcast-image {
        flex: 1 1 auto;
        width: 100%;
      }
    }
    .about-contact {
      display: flex;
      gap: 20px;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
    }
    .contact-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      background: rgba(237, 220, 213, 0.8);
      border: 1px solid rgba(133, 172, 126, 0.3);
      border-radius: 50%;
      text-decoration: none;
      color: rgba(133, 172, 126, 0.9);
      transition: all 200ms ease;
      padding: 8px;
    }
    .contact-icon:hover {
      background: rgba(218, 194, 198, 0.95);
      border-color: rgba(133, 172, 126, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,.3);
    }
    .contact-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: brightness(0) invert(1);
    }
    .hero-icons {
      display: flex;
      gap: 16px;
      justify-content: center;
      margin-top: 0; /* spacing handled by parent flexbox gap */
    }
    .hero-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      background: rgba(237, 220, 213, 0.8);
      border: 1px solid rgba(133, 172, 126, 0.3);
      border-radius: 50%;
      text-decoration: none;
      color: rgba(133, 172, 126, 0.9);
      transition: all 200ms ease;
      padding: 8px;
    }
    .hero-icon:hover {
      background: rgba(218, 194, 198, 0.95);
      border-color: rgba(133, 172, 126, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,.3);
    }
    .hero-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: brightness(0) invert(1);
    }

    .cta-section {
      border: 1px solid rgba(133, 172, 126, 0.3); border-radius: 12px;
      background: rgba(237, 220, 213, 0.6);
      box-shadow: 0 1px 2px rgba(0,0,0,.2), inset 0 1px 0 rgba(133, 172, 126, 0.2);
      padding: 18px; text-align: center;
    }
    .cta-tagline { font-size: clamp(28px, 5vw, 54px); margin: 6px 0 10px; }
    .cta-reach { color: rgba(255,255,255,.8); margin-bottom: 10px; }
    .cta-actions { display:flex; justify-content:center; gap: 10px; flex-wrap: wrap; }
    .cta-button { border: 1px solid rgba(255,255,255,.3); border-radius: 8px; padding: 10px 14px; color: var(--fg); text-decoration:none; background: rgba(30, 30, 30, 0.8); }
    .cta-button:hover { background: rgba(40, 40, 40, 0.95); }
    .cta-icon { width: 18px; height:18px; }

    /* Alternating layout for home page sections */
    .alternating-section {
      display: flex;
      align-items: center;
      gap: 48px;
      margin: 48px 0;
      flex-wrap: wrap;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 600ms ease, transform 600ms ease;
    }
    .alternating-section.fade-in {
      opacity: 1;
      transform: translateY(0);
    }
    .alternating-section.reverse {
      flex-direction: row-reverse;
    }
    .alternating-section .section-image {
      flex: 1 1 400px;
      min-width: 300px;
    }
    .alternating-section .section-image img {
      width: 100%;
      height: 400px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,.1);
      image-rendering: -webkit-optimize-contrast;
      image-rendering: auto;
      -ms-interpolation-mode: bicubic;
      backface-visibility: hidden;
      transform: translateZ(0);
      will-change: transform;
    }
    /* Specific styling for writing image to reduce graininess */
    #writing .section-image img {
      image-rendering: -webkit-optimize-contrast;
      image-rendering: auto;
      filter: contrast(1.08) brightness(1.03) saturate(1.05);
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }
    .alternating-section .section-content {
      flex: 1 1 400px;
      min-width: 300px;
    }
    .alternating-section h2 {
      font-size: clamp(36px, 5vw, 56px);
      margin: 0 0 20px;
      font-weight: 700;
      line-height: 1.2;
      color: var(--content-fg);
      border: none;
      padding: 0;
    }
    .alternating-section h2 a {
      color: inherit;
      text-decoration: none;
      transition: opacity 200ms ease;
    }
    .alternating-section h2 a:hover {
      opacity: 0.8;
    }
    .alternating-section .section-description {
      font-size: 18px;
      line-height: 1.7;
      color: rgba(0,0,0,.75);
      margin: 0 0 24px;
    }
    .alternating-section .section-link {
      display: inline-block;
      color: #85ac7e;
      text-decoration: none;
      font-weight: 500;
      font-size: 16px;
      transition: color 200ms ease;
    }
    .alternating-section .section-link:hover {
      color: #6b8f65;
    }
    @media (max-width: 768px) {
      .alternating-section {
        flex-direction: column !important;
        gap: 32px;
      }
      .alternating-section .section-image img {
        height: 300px;
      }
    }

    /* About placeholders */
    .content-section .about-image .ph { height: 320px; background: rgba(0,0,0,.06); border:1px solid rgba(0,0,0,.1); border-radius:10px; display:grid; place-items:center; color: rgba(0,0,0,.45); }
    .content-section .media-grid .ph { background: rgba(0,0,0,.06); border: 1px solid rgba(0,0,0,.1); color: rgba(0,0,0,.45); }
    .content-section .content-card .ph { background: rgba(0,0,0,.06); border:1px solid rgba(0,0,0,.1); color: rgba(0,0,0,.45); }


    .content {
      width: 100%;
      background: var(--content-bg);
      color: var(--content-fg);
      padding: 0 24px 40px 24px; /* no top padding */
      border-radius: 0;
      margin: 0 auto;
      max-width: none;
      box-sizing: border-box;
    }
    
    /* Content section styling - white background with black text */
    .content-section {
      background: var(--content-bg);
      color: var(--content-fg);
    }
    .content-section h2 {
      color: var(--content-fg);
      border-bottom: 2px solid rgba(0,0,0,.15);
    }
    .content-section .entry {
      background: rgba(0,0,0,.03);
      border: 1px solid rgba(0,0,0,.08);
    }
    .content-section .entry h3 {
      color: var(--content-fg);
    }
    .content-section .entry h4 {
      color: var(--content-fg);
    }
    .content-section .entry p {
      color: rgba(0,0,0,.85);
    }
    .content-section .meta {
      color: rgba(0,0,0,.65);
    }
    .content-section ul.bullets {
      color: rgba(0,0,0,.8);
    }
    .content-section .about-text p {
      color: rgba(0,0,0,.85);
    }
    .content-section .podcast-text h3 {
      color: var(--content-fg);
    }
    .content-section .podcast-text p {
      color: rgba(0,0,0,.85);
    }
    .content-section .content-card {
      background: rgba(0,0,0,.03);
      border: 1px solid rgba(0,0,0,.08);
    }
    .content-section .content-card h3 {
      color: var(--content-fg);
    }
    .content-section .content-card .meta {
      color: rgba(0,0,0,.65);
    }
    .content-section .content-card h3 a {
      border-bottom: 1px dotted rgba(0,0,0,.3);
    }
    .content-section .footer-section h4 {
      color: var(--content-fg);
    }
    .content-section .footer-section p {
      color: rgba(0,0,0,.7);
    }
    .content-section .footer-section a {
      color: rgba(0,0,0,.75);
      border-bottom: 1px dotted rgba(0,0,0,.3);
    }
    .content-section .footer-section a:hover {
      color: rgba(0,0,0,.9);
    }
    .content-section .footer-bottom {
      border-top: 1px solid rgba(0,0,0,.08);
      color: rgba(0,0,0,.6);
    }
    
    /* Improved link and button styling */
    .content-section a {
      color: #85ac7e;
      text-decoration: none;
      border-bottom: 2px solid transparent;
      transition: all 200ms ease;
      padding-bottom: 2px;
      font-weight: 500;
    }
    .content-section a:hover {
      color: #6b8f65;
      border-bottom-color: #85ac7e;
      transform: translateY(-1px);
    }
    .content-section a:active {
      color: #5a7a55;
      transform: translateY(0);
    }
    .content-section .entry a,
    .content-section .podcast-text a,
    .content-section .about-text a {
      color: #85ac7e;
      text-decoration: none;
      border-bottom: 2px solid rgba(133, 172, 126, 0.3);
      transition: all 200ms ease;
      padding-bottom: 2px;
      display: inline-block;
      font-weight: 500;
    }
    .content-section .entry a:hover,
    .content-section .podcast-text a:hover,
    .content-section .about-text a:hover {
      color: #6b8f65;
      border-bottom-color: #85ac7e;
      transform: translateY(-1px);
    }
    .content-section .entry a:active,
    .content-section .podcast-text a:active,
    .content-section .about-text a:active {
      color: #5a7a55;
      transform: translateY(0);
    }
    
    /* Improved button styling */
    .content-section button,
    .content-section .button,
    .content-section input[type="submit"],
    .content-section input[type="button"] {
      background: #85ac7e;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 200ms ease;
      box-shadow: 0 2px 4px rgba(133, 172, 126, 0.2);
      font-family: 'Merriweather', serif;
    }
    .content-section button:hover,
    .content-section .button:hover,
    .content-section input[type="submit"]:hover,
    .content-section input[type="button"]:hover {
      background: #6b8f65;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(133, 172, 126, 0.3);
    }
    .content-section button:active,
    .content-section .button:active,
    .content-section input[type="submit"]:active,
    .content-section input[type="button"]:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(133, 172, 126, 0.2);
    }

    /* Lightbox modal for images */
    .lightbox {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      animation: fadeIn 0.3s ease;
      overflow: auto;
    }
    .lightbox.active {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .lightbox-content {
      position: relative;
      max-width: 90vw;
      max-height: 90vh;
      margin: auto;
      animation: zoomIn 0.3s ease;
    }
    .lightbox-content img {
      max-width: 100%;
      max-height: 90vh;
      width: auto;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    }
    .lightbox-close {
      position: absolute;
      top: -40px;
      right: 0;
      color: #fff;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      line-height: 1;
      transition: opacity 0.2s ease;
    }
    .lightbox-close:hover {
      opacity: 0.7;
    }
    .lightbox-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: #fff;
      font-size: 32px;
      font-weight: bold;
      cursor: pointer;
      padding: 16px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      transition: background 0.2s ease;
      user-select: none;
    }
    .lightbox-nav:hover {
      background: rgba(0, 0, 0, 0.8);
    }
    .lightbox-prev {
      left: 20px;
    }
    .lightbox-next {
      right: 20px;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes zoomIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    @media (max-width: 768px) {
      .lightbox-nav {
        font-size: 24px;
        padding: 12px;
      }
      .lightbox-prev {
        left: 10px;
      }
      .lightbox-next {
        right: 10px;
      }
      .lightbox-close {
        top: -30px;
        font-size: 32px;
      }
    }

    @media (max-width: 768px) {
      .content-section {
        margin-top: 40px;
      }
      .entry {
        padding: 16px;
      }
      .content-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      .hero-section {
        min-height: 60vh;
      }
      .media-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      .media-grid img {
        height: 200px;
      }
    }

    /* Navbar styles */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(237, 220, 213, 0.96);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(133, 172, 126, 0.2);
      padding: 16px 24px;
      z-index: 100;
      opacity: 0;
      transform: translateY(-100%);
      transition: opacity 600ms ease, transform 600ms ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }
    .navbar.show {
      opacity: 1;
      transform: translateY(0);
    }
    .navbar-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .navbar-logo {
      font-size: 26px; /* 20px * 1.3 */
      font-weight: 700;
      color: var(--fg);
      text-decoration: none;
      letter-spacing: -0.01em;
    }
    .navbar-links {
      display: flex;
      gap: 24px;
      align-items: center;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .navbar-links a {
      color: var(--fg);
      text-decoration: none;
      font-size: 20.8px; /* 16px * 1.3 */
      font-weight: 500;
      padding: 8px 0;
      border-bottom: 2px solid transparent;
      transition: all 200ms ease;
    }
    .navbar-links a:hover {
      border-bottom-color: var(--fg);
      opacity: 0.8;
    }
    .navbar-links a.active {
      border-bottom-color: var(--fg);
      opacity: 1;
    }
    .navbar-social {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .navbar-social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(237, 220, 213, 0.82);
      border: 1px solid rgba(133, 172, 126, 0.3);
      border-radius: 50%;
      padding: 8px;
      transition: all 200ms ease;
      text-decoration: none;
    }
    .navbar-social a:hover {
      background: rgba(218, 194, 198, 0.95);
      border-color: rgba(133, 172, 126, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,.3);
    }
    .navbar-social img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: none;
    }
    /* Mobile menu button */
    .navbar-toggle {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      flex-direction: column;
      gap: 5px;
      width: 32px;
      height: 32px;
      justify-content: center;
      align-items: center;
    }
    .navbar-toggle span {
      display: block;
      width: 24px;
      height: 2px;
      background: var(--fg);
      transition: all 0.3s ease;
      border-radius: 2px;
    }
    .navbar-toggle.active span:nth-child(1) {
      transform: rotate(45deg) translate(7px, 7px);
    }
    .navbar-toggle.active span:nth-child(2) {
      opacity: 0;
    }
    .navbar-toggle.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }
    @media (max-width: 768px) {
      .navbar {
        padding: 12px 16px;
      }
      .navbar-content {
        flex-wrap: wrap;
      }
      .navbar-toggle {
        display: flex;
        order: 3;
      }
      .navbar-logo {
        font-size: 23.4px; /* 18px * 1.3 */
        flex: 1;
      }
      .navbar-links {
        display: none;
        width: 100%;
        flex-direction: column;
        gap: 0;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid rgba(133, 172, 126, 0.2);
        order: 4;
      }
      .navbar-links.active {
        display: flex;
      }
      .navbar-links li {
        width: 100%;
      }
      .navbar-links a {
        font-size: 18.2px; /* 14px * 1.3 */
        padding: 12px 0;
        display: block;
        width: 100%;
        border-bottom: 1px solid rgba(133, 172, 126, 0.1);
      }
      .navbar-social {
        order: 2;
        gap: 8px;
      }
      .navbar-social a { width: 36px; height: 36px; }
    }

    /* Footer styles */
    .footer {
      background: rgba(237, 220, 213, 0.95);
      border-top: 1px solid rgba(133, 172, 126, 0.2);
      padding: 40px 24px;
      margin-top: 80px;
      margin-right: 0;
      margin-left: calc(-50vw + 50%);
      margin-bottom: 0;
      width: 100vw; /* full-bleed */
      opacity: 0;
      transform: translateY(12px);
      filter: blur(2px);
      transition: opacity 600ms ease, transform 600ms ease, filter 600ms ease;
    }
    .site.show .footer {
      opacity: 1;
      transform: translateY(0);
      filter: blur(0);
    }
    .footer-content {
      max-width: 1400px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 32px;
    }
    .footer-section h4 {
      margin: 0 0 16px;
      font-size: 18px;
      font-weight: 600;
      color: rgba(133, 172, 126, 0.95);
    }
    .footer-section p {
      margin: 8px 0;
      color: rgba(133, 172, 126, 0.75);
      font-size: 15px;
      line-height: 1.6;
    }
    .footer-section a {
      color: rgba(133, 172, 126, 0.8);
      text-decoration: none;
      border-bottom: 1px dotted rgba(133, 172, 126, 0.4);
      transition: all 200ms ease;
    }
    .footer-section a:hover {
      border-bottom-style: solid;
      color: rgba(133, 172, 126, 0.95);
    }
    .footer-social {
      display: flex;
      gap: 12px;
      margin-top: 12px;
    }
    .footer-social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(237, 220, 213, 0.8);
      border: 1px solid rgba(133, 172, 126, 0.3);
      border-radius: 50%;
      padding: 8px;
    }
    .footer-social a:hover {
      background: rgba(218, 194, 198, 0.95);
      border-color: rgba(133, 172, 126, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    .footer-social img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: brightness(0) invert(1);
    }
    .footer-bottom {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid rgba(133, 172, 126, 0.2);
      text-align: center;
      color: rgba(133, 172, 126, 0.65);
      font-size: 14px;
    }
    @media (max-width: 768px) {
      .footer {
        padding: 32px 16px;
        margin-top: 60px;
      }
      .footer-content {
        grid-template-columns: 1fr;
        gap: 24px;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar" id="navbar" aria-label="Main navigation">
    <div class="navbar-content">
      <a href="#about" class="navbar-logo">Stella Xulin</a>
      <button class="navbar-toggle" id="navbar-toggle" aria-label="Toggle menu" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="navbar-links" id="navbar-links">
        <li><a href="/">Home</a></li>
        <li><a href="/music">Music</a></li>
        <li><a href="/research">Research</a></li>
        <li><a href="/education">Education</a></li>
        <li><a href="/writing">Writing</a></li>
        <li><a href="/cheerleading">Cheerleading</a></li>
        <li><a href="/art-podcast">Art</a></li>
      </ul>
      <div class="navbar-social">
        <a href="mailto:stellashengjia@gmail.com" aria-label="Email">
          <img src="media/logos/email.webp" alt="Email">
        </a>
        <a href="tel:+19597772389" aria-label="Phone">
          <img src="media/logos/phone.png" alt="Phone">
        </a>
        <a href="https://www.linkedin.com/in/stella-xulin-2a299932a?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer">
          <img src="media/logos/linkedin.png" alt="LinkedIn">
        </a>
      </div>
    </div>
  </nav>

  <div class="stage">
    <div class="rail-wrap" aria-label="Word selector animation" role="region">
      <div class="indicator" aria-hidden="true"></div>
      <div class="rail">
        <div id="track" class="track" aria-hidden="true"></div>
      </div>
      <div id="live" class="sr-only" aria-live="polite"></div>
    </div>

    <main id="site" class="site" aria-hidden="true">
      <!-- Cox site structure adapted to cream theme -->
      <section class="hero-section" aria-label="Hero">
        <div class="hero-slideshow">
          <div class="hero-slide active" style="background-image:url('media/farmingtonmusic/music1.jpg')"></div>
          <div class="hero-slide" style="background-image:url('media/farmingtonmusic/music2.jpg')"></div>
          <div class="hero-slide" style="background-image:url('media/farmingtonmusic/music3.jpg')"></div>
          <div class="hero-slide" style="background-image:url('media/farmingtonmusic/music4.jpg')"></div>
          <div class="hero-slide" style="background-image:url('media/farmingtonmusic/music5.jpg')"></div>
        </div>
        <div class="hero-content">
          <div class="calligraphy-container" id="calligraphy-container">
            <!-- SVG will be loaded here -->
          </div>
        </div>
      </section>

      <!-- Semicircle separator -->
      <div class="semicircle-separator" aria-hidden="true"></div>

      <div class="content">
        <section class="content-section" id="about">
          <h2 class="underlined">About</h2>
          <div class="about-content">
            <div class="about-image">
              <img src="media/random/pfp.png" alt="Stella Xulin">
            </div>
            <div class="about-text">
              <p>I'm a student researcher and organizer passionate about bridging engineering, biology, and music-led community projects. Based in Unionville, CT, I've conducted research at Yale School of Medicine and the University of Hartford, working on everything from epigenetic tools to sustainable civil engineering solutions. Beyond the lab, I lead FIRST Robotics teams, mentor students ages 9–14, and founded the Farmington Music Students Association, organizing concerts for 60+ musicians and partnering with senior homes and hospitals. My work blends technical precision with creative expression, whether I'm designing CAD models, building AI-driven music videos, or teaching elementary engineering classes.</p>
              <div class="about-contact">
                <a href="mailto:stellashengjia@gmail.com" class="contact-icon email" aria-label="Email">
                  <img src="media/logos/email.webp" alt="Email">
                </a>
                <a href="tel:+19597772389" class="contact-icon phone" aria-label="Phone">
                  <img src="media/logos/phone.png" alt="Phone">
                </a>
                <a href="https://www.linkedin.com/in/stella-xulin-2a299932a?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" class="contact-icon linkedin" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer">
                  <img src="media/logos/linkedin.png" alt="LinkedIn">
                </a>
              </div>
            </div>
          </div>
        </section>

        <section class="content-section" id="writing">
          <div class="alternating-section">
            <div class="section-content">
              <h2><a href="/writing">Writing</a></h2>
              <p class="section-description">I write to remember and to connect, keeping alive the two worlds that shaped me.</p>
              <a href="/writing" class="section-link">Read more →</a>
            </div>
            <div class="section-image">
              <img src="media/home/fml.png" alt="Writing">
            </div>
          </div>
        </section>

        <section class="content-section" id="research">
          <div class="alternating-section reverse">
            <div class="section-content">
              <h2><a href="/research">Research</a></h2>
              <p class="section-description">Conducted research at Yale School of Medicine's Yan Lab studying epigenetic editing, and at University of Hartford developing sustainable concrete solutions.</p>
              <a href="/research" class="section-link">Learn more →</a>
            </div>
            <div class="section-image">
              <img src="media/home/1234567890.png" alt="Research">
            </div>
          </div>
        </section>

        <section class="content-section" id="robotics">
          <div class="alternating-section">
            <div class="section-content">
              <h2><a href="/robotics">Engineering and Robotics</a></h2>
              <p class="section-description">Team Lead of a 60+ member FIRST Robotics program. Increased female membership by 50% and earned Team Sustainability and Gracious Professionalism Awards.</p>
              <a href="/robotics" class="section-link">Learn more →</a>
            </div>
            <div class="section-image">
              <img src="media/firstrobotics/1.jpg" alt="FIRST Robotics">
            </div>
          </div>
        </section>

        <section class="content-section" id="music">
          <div class="alternating-section reverse">
            <div class="section-content">
              <h2><a href="/music">Music</a></h2>
              <p class="section-description">Pianist and performer with first place in HMTA Rising Pianists Competition. Founder and President of Farmington Music Students Association, organizing concerts for 60+ musicians.</p>
              <a href="/music" class="section-link">Learn more →</a>
            </div>
            <div class="section-image">
              <img src="media/home/homemusic.png" alt="Music">
            </div>
          </div>
        </section>

        <section class="content-section" id="cheerleading">
          <div class="alternating-section">
            <div class="section-content">
              <h2><a href="/cheerleading">Cheerleading</a></h2>
              <p class="section-description">Four-time All-Academic athlete and CCC nominee. Coached elementary, middle school, and unified teams, helping earn the first CCC championship in school history.</p>
              <a href="/cheerleading" class="section-link">Learn more →</a>
            </div>
            <div class="section-image">
              <img src="media/home/bruh.png" alt="Cheerleading">
            </div>
          </div>
        </section>

        <section class="content-section" id="art-podcast">
          <div class="alternating-section reverse">
            <div class="section-content">
              <h2><a href="/art-podcast">Art & Podcast</a></h2>
              <p class="section-description">Visual artist exploring drawings and digital media. Host of S.H.E. podcast, featuring conversations with inspiring women in STEM.</p>
              <a href="/art-podcast" class="section-link">Learn more →</a>
            </div>
            <div class="section-image">
              <img src="media/home/artxdfgshrtsjrejurtsxtfjxtf.png" alt="Art & Podcast">
            </div>
          </div>
        </section>

        <section class="content-section" id="education">
          <div class="alternating-section">
            <div class="section-content">
              <h2><a href="/education">Education & Academics</a></h2>
              <p class="section-description">A dedicated student with a passion for learning. Programs include Yale Young Global Scholars, Barnard College NextGen Leadership Institute, and Kenyon Review Young Writers Workshops.</p>
              <a href="/education" class="section-link">Learn more →</a>
            </div>
            <div class="section-image">
              <img src="media/home/hiifanyoneislookingatfilenames.png" alt="Education">
            </div>
          </div>
        </section>

      </div>

      <!-- Footer -->
      <footer class="footer">
        <div class="footer-content">
          <div class="footer-section">
            <h4>Contact</h4>
            <p>
              <a href="mailto:stellashengjia@gmail.com">stellashengjia@gmail.com</a>
            </p>
            <p>
              <a href="tel:+19597772389">+1 (959) 777-2389</a>
            </p>
            <div class="footer-social">
              <a href="mailto:stellashengjia@gmail.com" aria-label="Email">
                <img src="media/logos/email.webp" alt="Email">
              </a>
              <a href="tel:+19597772389" aria-label="Phone">
                <img src="media/logos/phone.png" alt="Phone">
              </a>
              <a href="#" aria-label="LinkedIn">
                <img src="media/logos/linkedin.png" alt="LinkedIn">
              </a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025 Stella Xulin. All rights reserved.</p>
          <p><a href="https://charlierusso.dev/" target="_blank" rel="noopener noreferrer">Designed by Charles Russo</a></p>
        </div>
      </footer>
    </main>
  </div>

  <!-- Lightbox Modal -->
  <div id="lightbox" class="lightbox">
    <span class="lightbox-close">&times;</span>
    <span class="lightbox-nav lightbox-prev">&#8249;</span>
    <span class="lightbox-nav lightbox-next">&#8250;</span>
    <div class="lightbox-content">
      <img id="lightbox-image" src="" alt="">
    </div>
  </div>

  <script>
    (function () {
      // Prevent scrolling and ensure page starts at top
      window.scrollTo(0, 0);
      document.documentElement.classList.add('animating');
      
      // Prevent all scrolling during animation
      const preventScroll = (e) => {
        e.preventDefault();
        e.stopPropagation();
        return false;
      };
      
      // Block scroll events
      window.addEventListener('scroll', preventScroll, { passive: false });
      window.addEventListener('wheel', preventScroll, { passive: false });
      window.addEventListener('touchmove', preventScroll, { passive: false });
      document.addEventListener('scroll', preventScroll, { passive: false });
      
      // Function to re-enable scrolling
      const enableScrolling = () => {
        window.removeEventListener('scroll', preventScroll);
        window.removeEventListener('wheel', preventScroll);
        window.removeEventListener('touchmove', preventScroll);
        document.removeEventListener('scroll', preventScroll);
      };
      
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const track = document.getElementById('track');
      const site = document.getElementById('site');
      const live = document.getElementById('live');
      const railWrap = document.querySelector('.rail-wrap');
      const rail = document.querySelector('.rail');
      const stage = document.querySelector('.stage');

      // Check if we should skip animation
      const urlParams = new URLSearchParams(window.location.search);
      const skipParam = urlParams.get('skip') || urlParams.get('skipAnimation');
      
      // Check if user came from another page (same origin, different path)
      let cameFromAnotherPage = false;
      if (document.referrer) {
        try {
          const referrerUrl = new URL(document.referrer);
          const currentUrl = new URL(window.location.href);
          // Skip if referrer is same origin but different pathname
          cameFromAnotherPage = referrerUrl.origin === currentUrl.origin && 
                                referrerUrl.pathname !== currentUrl.pathname &&
                                referrerUrl.pathname !== '';
        } catch (e) {
          // If URL parsing fails, check if referrer is different from current
          cameFromAnotherPage = document.referrer !== window.location.href && document.referrer !== '';
        }
      }
      
      const shouldSkipAnimation = prefersReduced || skipParam !== null || cameFromAnotherPage;

      const words = [
        'Creative', 'Confident', 'Adventurous', 'Driven', 'Cheerful', 'Collaborative', 'Dreamer', 'Enthusiastic', 'Curious', 'Courageous',
        'Innovative', 'Passionate', 'Resilient', 'Inspiring', 'Thoughtful', 'Ambitious', 'Energetic', 'Focused', 'Disciplined', 'Determined',
        'Welcome!', 'Creative', 'Confident', 'Adventurous', 'Driven', 'Cheerful', 'Collaborative', 'Dreamer', 'Enthusiastic', 'Curious', 'Courageous',
        'Innovative', 'Passionate', 'Resilient', 'Inspiring', 'Thoughtful', 'Ambitious', 'Energetic', 'Focused', 'Disciplined', 'Determined'
      ];

      const targetWord = 'Welcome!';
      const durationMs = 4000; // faster landing

      if (shouldSkipAnimation) {
        // Skip animation: show final state immediately
        track.innerHTML = '';
        const end = document.createElement('span');
        end.className = 'word flash';
        end.textContent = targetWord;
        track.appendChild(end);
        site.classList.add('show');
        site.removeAttribute('aria-hidden');
        const navbar = document.getElementById('navbar');
        if (navbar) {
          navbar.classList.add('show');
        }
        live.textContent = 'Welcome!';
        document.documentElement.classList.remove('animating');
        enableScrolling();
        return;
      }

      // Build the track content (duplicate full sequence to ensure ample distance)
      const sequence = [...words, ...words];
      const wordEls = sequence.map((w) => {
        const span = document.createElement('span');
        span.className = 'word';
        span.textContent = w;
        track.appendChild(span);
        return span;
      });

      // Positioning step for vertical movement
      let offsetY = 0; // current translateY of the track
      let rafId = 0;
      let startTime = 0;
      let done = false;

      const getIndicatorY = () => {
        const wrap = track.parentElement.getBoundingClientRect();
        return wrap.top + wrap.height / 2;
      };

      // Keep a small map to avoid re-flashing continuously
      const flashed = new WeakSet();

      function easeOutCubic(t) {
        return 1 - Math.pow(1 - t, 3);
      }

      // Prepare start/end offsets; double the travel distance for 2x apparent speed
      const targetEl = wordEls.find(el => el.textContent === targetWord);
      const indicatorY = getIndicatorY();
      // compute current center for target at offset 0
      const rect0 = targetEl.getBoundingClientRect();
      const targetCenter0 = rect0.top + rect0.height / 2;
      const endOffsetY = indicatorY - targetCenter0; // needed to align
      const startOffsetY = endOffsetY + 2400; // start higher so it moves twice the distance in same time

      function tick(ts) {
        if (done) return;
        if (!startTime) startTime = ts;
        const elapsed = ts - startTime;
        const t = Math.min(1, elapsed / durationMs);
        const eased = easeOutCubic(t);

        offsetY = startOffsetY + (endOffsetY - startOffsetY) * eased;
        track.style.transform = `translateX(-50%) translateY(${offsetY}px)`;

        // Flash the word nearest the indicator
        const indicatorNow = getIndicatorY();
        let nearest = null;
        let nearestDist = Infinity;
        for (const el of wordEls) {
          const rect = el.getBoundingClientRect();
          const center = rect.top + rect.height / 2;
          const dist = Math.abs(center - indicatorNow);
          if (dist < nearestDist) {
            nearestDist = dist;
            nearest = el;
          }
        }

        if (nearest && !flashed.has(nearest)) {
          flashed.add(nearest);
          nearest.classList.add('flash');
          // Keep Welcome! at full opacity (no removal)
          if (nearest.textContent !== targetWord) {
            setTimeout(() => nearest.classList.remove('flash'), 220);
          }
          if (nearest.textContent) live.textContent = nearest.textContent;
        }

        if (t >= 1) {
          // Snap perfectly and reveal
          track.style.transform = `translateX(-50%) translateY(${endOffsetY}px)`;
          targetEl.classList.add('flash');
          live.textContent = targetWord;
          done = true;
          cancelAnimationFrame(rafId);
          // After 0.75s, shrink the slider vertically, then hide; 1s later show the site
          setTimeout(() => {
            rail.classList.add('shrink-out');
            const onShrinkDone = () => {
              railWrap.style.display = 'none';
              // start fade-in after 1s for a smoother reveal
              setTimeout(() => {
                stage.classList.add('site-mode');
                site.classList.add('show');
                site.removeAttribute('aria-hidden');
                // Show navbar
                const navbar = document.getElementById('navbar');
                if (navbar) {
                  navbar.classList.add('show');
                }
                // Re-enable scrolling after animation completes
                document.documentElement.classList.remove('animating');
                enableScrolling();
              }, 1000);
            };
            rail.addEventListener('transitionend', onShrinkDone, { once: true });
            // Fallback if transitionend doesn't fire
            setTimeout(onShrinkDone, 520);
          }, 750);
          return;
        }

        rafId = requestAnimationFrame(tick);
      }

      // Kick off
      track.style.transform = `translateX(-50%) translateY(${startOffsetY}px)`;
      rafId = requestAnimationFrame(tick);

      // Resize handler to keep alignment robust
      let resizeTimer;
      window.addEventListener('resize', () => {
        if (done) return;
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
          track.style.willChange = 'transform';
          requestAnimationFrame(() => {
            track.style.willChange = 'auto';
          });
        }, 120);
      });
    })();
  </script>
  <script>
    // Cream-themed adaptations for Cox sections
    (function(){
      // Hero slideshow rotation
      const slides = document.querySelectorAll('.hero-slide');
      if (slides.length) {
        let i = 0;
        setInterval(() => {
          slides[i].classList.remove('active');
          i = (i + 1) % slides.length;
          slides[i].classList.add('active');
        }, 5000);
      }

    })();
  </script>
  <script>
    // Lightbox functionality for gallery images
    (function() {
      const lightbox = document.getElementById('lightbox');
      const lightboxImage = document.getElementById('lightbox-image');
      const lightboxClose = document.querySelector('.lightbox-close');
      const lightboxPrev = document.querySelector('.lightbox-prev');
      const lightboxNext = document.querySelector('.lightbox-next');
      const galleryImages = document.querySelectorAll('.gallery-image');
      
      let currentIndex = 0;
      let images = [];
      
      // Collect all gallery images
      galleryImages.forEach(img => {
        images.push({
          src: img.src,
          alt: img.alt
        });
      });
      
      function openLightbox(index) {
        if (images.length === 0) return;
        currentIndex = index;
        updateLightboxImage();
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
      }
      
      function closeLightbox() {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
      }
      
      function updateLightboxImage() {
        if (images.length === 0) return;
        const image = images[currentIndex];
        lightboxImage.src = image.src;
        lightboxImage.alt = image.alt;
        
        // Show/hide navigation arrows
        lightboxPrev.style.display = images.length > 1 ? 'block' : 'none';
        lightboxNext.style.display = images.length > 1 ? 'block' : 'none';
      }
      
      function showNext() {
        if (images.length === 0) return;
        currentIndex = (currentIndex + 1) % images.length;
        updateLightboxImage();
      }
      
      function showPrev() {
        if (images.length === 0) return;
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        updateLightboxImage();
      }
      
      // Event listeners
      galleryImages.forEach((img, index) => {
        img.addEventListener('click', () => openLightbox(index));
      });
      
      lightboxClose.addEventListener('click', closeLightbox);
      lightboxPrev.addEventListener('click', showPrev);
      lightboxNext.addEventListener('click', showNext);
      
      // Close on background click
      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
          closeLightbox();
        }
      });
      
      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (!lightbox.classList.contains('active')) return;
        
        if (e.key === 'Escape') {
          closeLightbox();
        } else if (e.key === 'ArrowLeft') {
          showPrev();
        } else if (e.key === 'ArrowRight') {
          showNext();
        }
      });
    })();
  </script>
  <script>
    // Navbar smooth scrolling and active link highlighting
    (function() {
      const navbar = document.getElementById('navbar');
      if (!navbar) return;
      
      const navLinks = navbar.querySelectorAll('.navbar-links a');
      const logoLink = navbar.querySelector('.navbar-logo');
      const sections = document.querySelectorAll('section[id]');
      
      // Smooth scroll function
      function smoothScrollTo(targetId) {
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
          const offsetTop = targetSection.getBoundingClientRect().top + window.pageYOffset - 80; // Account for navbar height
          window.scrollTo({
            top: offsetTop,
            behavior: 'smooth'
          });
        }
      }
      
      // Smooth scroll for navbar links
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          if (href.startsWith('#')) {
            e.preventDefault();
            const targetId = href.substring(1);
            smoothScrollTo(targetId);
          }
        });
      });
      
      // Smooth scroll for logo
      if (logoLink) {
        logoLink.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          if (href.startsWith('#')) {
            e.preventDefault();
            const targetId = href.substring(1);
            smoothScrollTo(targetId);
          }
        });
      }
      
      // Update active link on scroll
      function updateActiveLink() {
        let current = '';
        const scrollPos = window.pageYOffset + 100; // Offset for navbar
        
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.offsetHeight;
          if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
            current = section.getAttribute('id');
          }
        });
        
        navLinks.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
          }
        });
      }
      
      // Throttle scroll event
      let ticking = false;
      window.addEventListener('scroll', function() {
        if (!ticking) {
          window.requestAnimationFrame(function() {
            updateActiveLink();
            ticking = false;
          });
          ticking = true;
        }
      });
      
      // Initial update
      updateActiveLink();
    })();
  </script>
  <script>
    // Calligraphy animation for "Stella Xulin"
    (function() {
      const container = document.getElementById('calligraphy-container');
      if (!container) return;
      
      // Load SVG and animate when site is shown
      function initCalligraphy() {
        fetch('media/text.svg')
          .then(response => response.text())
          .then(svgText => {
            // Insert SVG into container
            container.innerHTML = svgText;
            
            // Wait a bit for SVG to render
            setTimeout(() => {
              const svg = container.querySelector('svg');
              if (!svg) return;
              
              // Get all drawable elements (paths, polylines, lines)
              const drawableElements = svg.querySelectorAll('path, polyline, line');
              
              if (drawableElements.length === 0) return;
              
              // Use anime.js v4 createDrawable API
              if (window.animejs && window.animejs.svg && window.animejs.svg.createDrawable) {
                const { animate, svg: svgModule, stagger } = window.animejs;
                
                // Create drawable proxies for all paths
                const drawables = [];
                drawableElements.forEach(el => {
                  const drawable = svgModule.createDrawable(el);
                  if (drawable && drawable.length > 0) {
                    drawables.push(drawable[0]);
                  }
                });
                
                if (drawables.length > 0) {
                  // Animate the drawing
                  animate(drawables, {
                    draw: ['0 0', '0 1'],
                    duration: 16000, /* 0.5x speed (2x slower) */
                    delay: stagger(100),
                    ease: 'inOutQuad'
                  });
                }
              } else if (window.anime) {
                // Fallback for older anime.js versions
                const drawables = Array.from(drawableElements);
                window.anime({
                  targets: drawables,
                  strokeDashoffset: [function(el) {
                    return el.getTotalLength();
                  }, 0],
                  duration: 16000, /* 0.5x speed (2x slower) */
                  delay: window.anime.stagger(100),
                  easing: 'easeInOutQuad',
                  begin: function(anim) {
                    anim.animatables.forEach(animatable => {
                      const el = animatable.target;
                      const length = el.getTotalLength();
                      el.style.strokeDasharray = length;
                      el.style.strokeDashoffset = length;
                    });
                  }
                });
              } else {
                // Final fallback: CSS animation
                drawableElements.forEach((el, index) => {
                  const pathLength = el.getTotalLength ? el.getTotalLength() : 100;
                  el.style.strokeDasharray = pathLength;
                  el.style.strokeDashoffset = pathLength;
                  
                  setTimeout(() => {
                    el.style.transition = 'stroke-dashoffset 12s ease-in-out'; /* 0.5x speed (2x slower) */
                    el.style.strokeDashoffset = 0;
                  }, index * 100);
                });
              }
            }, 100);
          })
          .catch(error => {
            console.error('Error loading calligraphy SVG:', error);
            // Fallback: show text if SVG fails to load
            container.innerHTML = '<h1 style="margin: 0; color: var(--fg);">Stella Xulin</h1>';
          });
      }
      
      // Wait for site to be shown, then initialize
      const site = document.getElementById('site');
      if (site && site.classList.contains('show')) {
        initCalligraphy();
      } else {
        // Watch for site to be shown
        const observer = new MutationObserver((mutations) => {
          if (site.classList.contains('show')) {
            initCalligraphy();
            observer.disconnect();
          }
        });
        if (site) {
          observer.observe(site, { attributes: true, attributeFilter: ['class'] });
        }
        // Also try after a delay in case observer doesn't catch it
        setTimeout(initCalligraphy, 3000);
      }
    })();
  </script>
  <script>
    // Scroll fade-in animation for sections
    (function() {
      // Only run on home page
      if (window.location.pathname !== '/' && window.location.pathname !== '/index.html' && !window.location.pathname.endsWith('/')) {
        return;
      }

      const observerOptions = {
        threshold: 0.15,
        rootMargin: '0px 0px -50px 0px'
      };

      const fadeInObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('fade-in');
            // Stop observing after animation
            fadeInObserver.unobserve(entry.target);
          }
        });
      }, observerOptions);

      // Wait for site to be shown before observing
      const site = document.getElementById('site');
      function initFadeIn() {
        // Observe all alternating sections
        const sections = document.querySelectorAll('.alternating-section');
        sections.forEach(section => {
          fadeInObserver.observe(section);
        });
      }

      if (site && site.classList.contains('show')) {
        initFadeIn();
      } else {
        const checkSite = setInterval(() => {
          if (site && site.classList.contains('show')) {
            initFadeIn();
            clearInterval(checkSite);
          }
        }, 100);
        // Fallback timeout
        setTimeout(() => {
          clearInterval(checkSite);
          initFadeIn();
        }, 5000);
      }

      // Also observe when site becomes visible (for initial load)
      const siteObserver = new MutationObserver(() => {
        if (site && site.classList.contains('show')) {
          initFadeIn();
          siteObserver.disconnect();
        }
      });
      if (site) {
        siteObserver.observe(site, { attributes: true, attributeFilter: ['class'] });
      }
    })();
  </script>
  <script>
    // Update Home links to include skip parameter when navigating from other pages
    (function() {
      const homeLinks = document.querySelectorAll('a[href="/"], a[href="#about"]');
      const isHomePage = window.location.pathname === '/' || window.location.pathname === '/index.html' || window.location.pathname.endsWith('/');
      
      homeLinks.forEach(link => {
        // If we're on a section page, add skip parameter to home links
        if (!isHomePage && link.getAttribute('href') === '/') {
          link.setAttribute('href', '/?skip');
        }
        // If we're on home page and link points to #about, add skip parameter
        if (isHomePage && link.getAttribute('href') === '#about') {
          link.addEventListener('click', function(e) {
            // If coming from another page, the referrer check will handle it
            // But we can also add the parameter explicitly
            if (document.referrer && document.referrer !== window.location.href) {
              window.location.href = '/?skip#about';
              e.preventDefault();
            }
          });
        }
      });
    })();
  </script>
  
  <script>
    // Mobile menu toggle - ensure it works with ?skip parameter
    (function() {
      let initialized = false;
      
      function initMobileMenu() {
        if (initialized) return;
        
        const toggle = document.getElementById('navbar-toggle');
        const links = document.getElementById('navbar-links');
        
        if (toggle && links) {
          initialized = true;
          
          toggle.addEventListener('click', () => {
            toggle.classList.toggle('active');
            links.classList.toggle('active');
            toggle.setAttribute('aria-expanded', toggle.classList.contains('active'));
          });
          
          // Close menu when clicking on a link
          links.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
              toggle.classList.remove('active');
              links.classList.remove('active');
              toggle.setAttribute('aria-expanded', 'false');
            });
          });
        }
      }
      
      // Run when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initMobileMenu);
      } else {
        initMobileMenu();
      }
      
      // Also run after navbar is shown (for ?skip case and normal load)
      const checkNavbar = setInterval(() => {
        const navbar = document.getElementById('navbar');
        if (navbar && navbar.classList.contains('show')) {
          initMobileMenu();
          clearInterval(checkNavbar);
        }
      }, 50);
      
      // Fallback timeout
      setTimeout(() => {
        clearInterval(checkNavbar);
        initMobileMenu();
      }, 500);
    })();
  </script>
</body>
</html>


